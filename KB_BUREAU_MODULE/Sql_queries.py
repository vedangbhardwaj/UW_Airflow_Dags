import pandas as pd

# SQL Query - getting raw data:
get_raw_data = """
    select  
        user_id,loan_id,disbursed_date,
        ever15DPD_in_60days,
        ever15DPD_in_90days as BAD_FLAG,
        BUREAUSCORE,
        CREDITACCOUNTTOTAL,
        CREDITACCOUNTACTIVE,
        CREDITACCOUNTDEFAULT,
        CREDITACCOUNTCLOSED,
        CADSUITFILEDCURRENTBALANCE,
        OUTSTANDING_BALANCE_SECURED,
        OUTSTANDING_BALANCE_SECURED_PERCENTAGE,
        OUTSTANDING_BALANCE_UNSECURED,
        OUTSTANDING_BALANCE_UNSECURED_PERCENTAGE,
        OUTSTANDING_BALANCE_ALL,
        ACCOUNT_TYPE_COUNT,
        CREDIT_CARDS_COUNT,
        SECURED_ACCOUNT_COUNT,
        UNSECURED_ACCOUNT_COUNT,
        CREDIT_LIMIT_AMOUNT_MAX,
        CREDIT_LIMIT_AMOUNT_AVG,
        HIGHEST_CREDIT_OR_ORIGINAL_LOAN_AMOUNT_SUM,
        HIGHEST_CREDIT_OR_ORIGINAL_LOAN_AMOUNT_AVG,
        HIGHEST_CREDIT_OR_ORIGINAL_LOAN_AMOUNT_MAX,
        TERMS_DURATION_AVG,
        TERMS_DURATION_MAX,
        SCHEDULED_MONTHLY_PAYMENT_AMOUNT_SUM,
        SCHEDULED_MONTHLY_PAYMENT_AMOUNT_AVG,
        SCHEDULED_MONTHLY_PAYMENT_AMOUNT_MAX,
        ACCOUNT_STATUS_ACTIVE,
        ACCOUNT_STATUS_CLOSED,
        CURRENT_BALANCE_SUM,
        CURRENT_BALANCE_AVG,
        CURRENT_BALANCE_MAX,
        CURRENT_BALANCE_MIN,
        AMOUNT_PAST_DUE_SUM,
        AMOUNT_PAST_DUE_AVG,
        AMOUNT_PAST_DUE_MAX,
        ORIGINAL_CHARGE_OFF_AMOUNT_SUM,
        ORIGINAL_CHARGE_OFF_AMOUNT_AVG,
        ORIGINAL_CHARGE_OFF_AMOUNT_MAX,
        DAYS_SINCE_FIRST_DELINQUENCY,
        DAYS_SINCE_LAST_PAYMENT,
        SUITFILEDWILLFULDEFAULTWRITTENOFFSTATUS,
        SUITFILED_WILFULDEFAULT,
        VALUE_OF_CREDITS_LAST_MONTH_SUM,
        VALUE_OF_CREDITS_LAST_MONTH_AVG,
        VALUE_OF_CREDITS_LAST_MONTH_MAX,
        SETTLEMENT_AMOUNT_SUM,
        SETTLEMENT_AMOUNT_AVG,
        SETTLEMENT_AMOUNT_MAX,
        VALUE_OF_COLLATERAL_SUM,
        VALUE_OF_COLLATERAL_AVG,
        VALUE_OF_COLLATERAL_MAX,
        TYPE_OF_COLLATERAL,
        WRITTEN_OFF_AMT_TOTAL_SUM,
        WRITTEN_OFF_AMT_TOTAL_AVG,
        WRITTEN_OFF_AMT_TOTAL_MAX,
        WRITTEN_OFF_AMT_PRINCIPAL_SUM,
        WRITTEN_OFF_AMT_PRINCIPAL_AVG,
        WRITTEN_OFF_AMT_PRINCIPAL_MAX,
        RATE_OF_INTEREST_AVG,
        RATE_OF_INTEREST_MAX,
        RATE_OF_INTEREST_MIN,
        REPAYMENT_TENURE_AVG,
        REPAYMENT_TENURE_MAX,
        DAYS_SINCE_LAST_DEFAULT_STATUS,
        DAYS_SINCE_LAST_LITIGATION_STATUS,
        DAYS_SINCE_LAST_WRITE_OFF_STATUS,
        MAX_DPD_LAST_1_MONTH,
        MAX_DPD_LAST_3_MONTHS,
        MAX_DPD_LAST_6_MONTHS,
        MAX_DPD_LAST_9_MONTHS,
        MAX_DPD_LAST_12_MONTHS,
        MAX_DPD_LAST_24_MONTHS,
        MAX_DPD_LAST_1_MONTH_ACTIVE,
        MAX_DPD_LAST_3_MONTHS_ACTIVE,
        MAX_DPD_LAST_6_MONTHS_ACTIVE,
        MAX_DPD_LAST_9_MONTHS_ACTIVE,
        MAX_DPD_LAST_12_MONTHS_ACTIVE,
        MAX_DPD_LAST_24_MONTHS_ACTIVE,
        NO_OF_TIMES_30_DPD_3MONTHS,
        NO_OF_TIMES_30_DPD_6MONTHS,
        NO_OF_TIMES_30_DPD_9MONTHS,
        NO_OF_TIMES_30_DPD_12MONTHS,
        NO_OF_TIMES_30_DPD_3MONTHS_ACTIVE,
        NO_OF_TIMES_30_DPD_6MONTHS_ACTIVE,
        NO_OF_TIMES_30_DPD_9MONTHS_ACTIVE,
        NO_OF_TIMES_30_DPD_12MONTHS_ACTIVE,
        NO_OF_TIMES_60_DPD_3MONTHS,
        NO_OF_TIMES_60_DPD_6MONTHS,
        NO_OF_TIMES_60_DPD_9MONTHS,
        NO_OF_TIMES_60_DPD_12MONTHS,
        NO_OF_TIMES_60_DPD_3MONTHS_ACTIVE,
        NO_OF_TIMES_60_DPD_6MONTHS_ACTIVE,
        NO_OF_TIMES_60_DPD_9MONTHS_ACTIVE,
        NO_OF_TIMES_60_DPD_12MONTHS_ACTIVE,
        NO_OF_TIMES_90_DPD_3MONTHS,
        NO_OF_TIMES_90_DPD_6MONTHS,
        NO_OF_TIMES_90_DPD_9MONTHS,
        NO_OF_TIMES_90_DPD_12MONTHS,
        NO_OF_TIMES_90_DPD_3MONTHS_ACTIVE,
        NO_OF_TIMES_90_DPD_6MONTHS_ACTIVE,
        NO_OF_TIMES_90_DPD_9MONTHS_ACTIVE,
        NO_OF_TIMES_90_DPD_12MONTHS_ACTIVE,
        MONTHS_SINCE_30_DPD,
        MONTHS_SINCE_60_DPD,
        MONTHS_SINCE_90_DPD,
        MONTHS_SINCE_30_DPD_ACTIVE,
        MONTHS_SINCE_60_DPD_ACTIVE,
        MONTHS_SINCE_90_DPD_ACTIVE,
        TOTALCAPSLAST7DAYS,
        TOTALCAPSLAST30DAYS,
        TOTALCAPSLAST90DAYS,
        TOTALCAPSLAST180DAYS,
        CAPSLAST7DAYS,
        CAPSLAST30DAYS,
        CAPSLAST90DAYS,
        CAPSLAST180DAYS,
        RESIDENCE_CODE_NON_NORMALIZED,
        AGE_OF_OLDEST_ACCOUNT_DAYS,
        ACCOUNT_OPEN_1MONTH,
        ACCOUNT_OPEN_2MONTHS,
        ACCOUNT_OPEN_3MONTHS,
        ACCOUNT_OPEN_6MONTHS,
        ACCOUNT_OPEN_12MONTHS,
        MAX_DPD_LAST_1_MONTH_SECURED,
        MAX_DPD_LAST_3_MONTHS_SECURED,
        MAX_DPD_LAST_6_MONTHS_SECURED,
        MAX_DPD_LAST_9_MONTHS_SECURED,
        MAX_DPD_LAST_12_MONTHS_SECURED,
        MAX_DPD_LAST_24_MONTHS_SECURED,
        MAX_DPD_LAST_1_MONTH_UNSECURED,
        MAX_DPD_LAST_3_MONTHS_UNSECURED,
        MAX_DPD_LAST_6_MONTHS_UNSECURED,
        MAX_DPD_LAST_9_MONTHS_UNSECURED,
        MAX_DPD_LAST_12_MONTHS_UNSECURED,
        MAX_DPD_LAST_24_MONTHS_UNSECURED,
        PAYMENT_WITHOUT_DPD_LAST_1_MONTH,
        PAYMENT_WITHOUT_DPD_LAST_3_MONTHS,
        PAYMENT_WITHOUT_DPD_LAST_6_MONTHS,
        PAYMENT_WITHOUT_DPD_LAST_9_MONTHS,
        PAYMENT_WITHOUT_DPD_LAST_12_MONTHS
    from  ANALYTICS.KB_ANALYTICS.A1_UW_model_lending_Bureau_base_v1
    where date(disbursed_date)>=date('{sd}')
    and date(disbursed_date)<=date('{ed}')
    """
# SQL Query - getting transformed data:
get_transformed_data = """
        SELECT * from ANALYTICS.KB_ANALYTICS.airflow_demo_write_transformed_kb_bureau_module 
        """

get_transformed_woe_data = """
        SELECT * from ANALYTICS.KB_ANALYTICS.airflow_demo_write_transformed_woe_kb_bureau_module 
        """
